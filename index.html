<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>フォルダ内ファイル結合</title>
<style>
body { font-family: sans-serif; padding: 20px; }
textarea { width: 100%; height: 400px; margin-top: 10px; }
</style>
</head>
<body>

<h2>文字系ファイルをフォルダごとアップロードして結合</h2>
<input type="file" id="folderInput" webkitdirectory multiple>
<button id="processBtn">結合して表示</button>

<textarea id="output" placeholder="ここに結合結果が表示されます"></textarea>

<script>
const folderInput = document.getElementById('folderInput');
const processBtn = document.getElementById('processBtn');
const output = document.getElementById('output');

const allowedExtensions = ['htm','html','java','yml','txt','css','js']; // 必要に応じて追加

processBtn.addEventListener('click', () => {
    const files = Array.from(folderInput.files);
    const filteredFiles = files.filter(f => {
        const ext = f.name.split('.').pop().toLowerCase();
        return allowedExtensions.includes(ext);
    });

    if(filteredFiles.length === 0){
        alert('対象ファイルがありません');
        return;
    }

    let results = [];

    let readCount = 0;
    filteredFiles.forEach(file => {
        const reader = new FileReader();
        reader.onload = (e) => {
            results.push(`--- ${file.webkitRelativePath} ---\n${e.target.result}\n\n`);
            readCount++;
            if(readCount === filteredFiles.length){
                // パス順に並べる
                results.sort();
                output.value = results.join('');
            }
        };
        reader.readAsText(file, 'UTF-8');
    });
});
</script>

</body>
</html>
